/**
 * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH
 * under one or more contributor license agreements. See the NOTICE file
 * distributed with this work for additional information regarding copyright
 * ownership.
 *
 * Camunda licenses this file to you under the MIT; you may not use this file
 * except in compliance with the MIT License.
 */

import generateImage from '../generateImage';

import { keys } from 'min-dash';

const EXCPECTED_JPEG_DATAURL = 'data:image/jpeg;base64,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';

const EXPECTED_PNG_DATAURL = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQCAYAAADnRuK4AAASRklEQVR4Xu2dCfBW0xvHn7IrkX2pULaxmyxFZEmyJIqsoZSlIktDkT2lRiK7SBSVkC1bkQymkH0nhexZKrLLfM7//zbNfc95l3vO3d57vjPv/Gbqvfee89zve+85z/J96ixZsmSJeHgLhLRAHU+gkJbzhykLeAJ5IlhZwBPIynz+YE8gzwErC3gCWZnPH+wJ5DlgZQFPICvz+YM9gTwHrCzgCWRlPn+wJ5DngJUFPIGszOcP9gTyHLCygCeQlfn8wZ5AngNWFsglgT777DP59NNPZfbs2TJnzhz196uvvpJFixbJr7/+uvSzYMECZdzVV19d6tWrt/Sz2mqryYYbbiibbbaZbLrpptKsWTNp2rSpNGnSxOpmZPHgmifQL7/8Ii+99JK88MIL8uKLL8rMmTMVQaJA/fr1pUWLFrLHHntIq1atZPfdd5dVV101ikul5pw1SaD58+fLqFGjZMKECfLaa68lauydd95Zjj76aDnxxBNl7bXXTnQsUVy8Zgj0zz//yJNPPil33HGHPPbYY/LXX39FYa/Q51xhhRWkQ4cO0r17d9l///2lbt26oc+VpgMzT6CFCxfK9ddfLzfffLN8+eWXabKtcSyNGjWSXr16Sc+ePaVBgwaZGLNpkJklEIveYcOGyciRI9XiN4uAPKeeeqqcc845sv7662dxCtlLaf3www9l0KBBcvfdd1sZfIMNNpAttthCttxyS7Wb2nbbbaVhw4bCQphdFn/XWmstdY0ffvhBWIxDVP7++OOP8s4778gnn3wiH330kTCmb775xmo8rJH69++vxpMlZOYJxM0777zz5NZbb5VqC0nYcu+yyy7qs+uuu8puu+3m/NXBln/GjBnyyiuvqM/LL79cNanq1Kkjp59+ugwdOlS5DLKATBDo6aeflpNOOkm+/vrrim265ppryrHHHivdunWTnXbaqeLjXH5x1qxZcuedd8q9994rP/30U8WnZo3EZqBt27YVH5PUF1NPoNNOO009dSoFO5wePXrIkUceWekhsXxv4sSJar02ZcqUiq/Xu3dvtUFIM1JLINYVnTp1knfffbes/ZZbbjlFmIsuuki23nrrst9P8gtvv/22XHnllXL//fcLrody2GabbeThhx9W3u40IpUE4rF/xhlnlPUY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';

const expectedImagesByType = {
  png: EXPECTED_PNG_DATAURL,
  jpeg: EXCPECTED_JPEG_DATAURL
};

describe('util - generateImage', function() {

  const svg = require('./diagram.svg'),
        outOfBoundsSVG = require('./out_of_bounds_diagram.svg');

  keys(expectedImagesByType).forEach(function(type) {

    it('should export <' + type + '>', function() {

      const image = generateImage(type, svg);

      expect(image).to.exist;
    });


    it('should automatically handle large images <' + type + '>', function() {

      const image = generateImage(type, outOfBoundsSVG);

      // if image cannot be generated properly it returns a data string with
      // 6 characters. If it is generated, image.length returns the actual size
      // of the generated image which is more than 6.
      expect(image.length).to.be.greaterThan(6);
    }).timeout(10000); // downscaling may exceed the default timeout 2000ms.


    it('should generate expected images <' + type + '>', function() {

      const image = generateImage(type, svg),
            expectedImage = expectedImagesByType[ type ];

      expect(image).to.be.eql(expectedImage);
    });
  });

});
